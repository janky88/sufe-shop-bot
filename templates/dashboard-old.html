<!DOCTYPE html>
<html data-theme="light">
<head>
    <title>ä»ªè¡¨ç›˜ - å•†åŸæœºå™¨äººç®¡ç†ä¸­å¿ƒ</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#ffffff">
    <link rel="stylesheet" href="/static/css/theme.css?v=2">
    <link rel="stylesheet" href="/static/css/components.css?v=2">
    <link rel="stylesheet" href="/static/css/layout.css?v=1">
    <link rel="stylesheet" href="/static/css/layout.css?v=1">
    <link rel="stylesheet" href="/static/css/pages/dashboard.css?v=2">
    <script>
    function logout() {
        fetch('/api/logout', { method: 'POST' })
            .then(() => window.location.href = '/')
            .catch(err => console.error('Logout failed:', err));
    }
    </script>
    <link rel="stylesheet" href="/static/ui-enhancements.css?v=1">
</head>
<body class="page-container aurora-background">
    <div class="header">
        <div class="header-content">
            <div class="logo">å•†åŸæœºå™¨äººç®¡ç†ä¸­å¿ƒ</div>
            <div class="header-actions">
                <button class="theme-toggle" onclick="toggleTheme()" title="åˆ‡æ¢ä¸»é¢˜ (Ctrl+Shift+T)">
                    <span class="theme-toggle-icon sun">â˜€ï¸</span>
                    <span class="theme-toggle-icon moon">ğŸŒ™</span>
                </button>
                <button class="btn btn-danger" onclick="logout()">é€€å‡ºç™»å½•</button>
            </div>
        </div>
    </div>
    
    <div class="container">
        <div class="nav">
            <a href="/admin/" class="active">ä»ªè¡¨ç›˜</a>
            <a href="/admin/products">å•†å“ç®¡ç†</a>
            <a href="/admin/orders">è®¢å•ç®¡ç†</a>
            <a href="/admin/users">ç”¨æˆ·ç®¡ç†</a>
            <a href="/admin/recharge-cards">å……å€¼å¡ç®¡ç†</a>
            <a href="/admin/broadcast">æ¶ˆæ¯æ¨é€</a>
            <a href="/admin/faq">FAQç®¡ç†</a>
            <a href="/admin/templates">æ¶ˆæ¯æ¨¡æ¿</a>
            <a href="/admin/settings">ç³»ç»Ÿè®¾ç½®</a>
        </div>
        
        <h1 class="page-title">ä»ªè¡¨ç›˜</h1>
        
        <div class="quick-actions">
            <a href="/admin/products" class="btn">å•†å“ç®¡ç†</a>
            <a href="/admin/orders" class="btn btn-success">è®¢å•ç®¡ç†</a>
            <a href="/admin/broadcast" class="btn btn-danger">å‘é€å¹¿æ’­</a>
        </div>
        
        <div class="stats">
            <div class="stat-card">
                <canvas class="stat-chart" width="100" height="40" data-type="line" data-values="[10,15,12,20,18,25,30]" data-color="#667eea"></canvas>
                <div class="stat-value">{{.stats.TotalUsers}}</div>
                <div class="stat-label">æ€»ç”¨æˆ·æ•°</div>
                <div class="stat-trend positive">â†‘ 12.5%</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">{{.stats.TotalProducts}}</div>
                <div class="stat-label">å•†å“æ•°é‡</div>
            </div>
            <div class="stat-card">
                <canvas class="stat-chart" width="100" height="40" data-type="bar" data-values="[5,8,6,10,12,15,18]" data-color="#10b981"></canvas>
                <div class="stat-value">{{.stats.TotalOrders}}</div>
                <div class="stat-label">æ€»è®¢å•æ•°</div>
                <div class="stat-trend positive">â†‘ 8.2%</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">{{.currency}}{{printf "%.2f" (divf .stats.TotalRevenue 100)}}</div>
                <div class="stat-label">æ€»æ”¶å…¥</div>
            </div>
            <div class="stat-card">
                <canvas class="stat-chart" width="100" height="40" data-type="line" data-values="[2,3,5,4,6,8,10]" data-color="#fb923c"></canvas>
                <div class="stat-value">{{.stats.TodayOrders}}</div>
                <div class="stat-label">ä»Šæ—¥è®¢å•</div>
                <div class="stat-trend negative">â†“ 3.1%</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">{{.currency}}{{printf "%.2f" (divf .stats.TodayRevenue 100)}}</div>
                <div class="stat-label">ä»Šæ—¥æ”¶å…¥</div>
            </div>
        </div>
        
        <div class="charts-section">
            <div class="chart-container glass-card">
                <h3 class="chart-title">é”€å”®è¶‹åŠ¿</h3>
                <canvas id="salesChart" width="400" height="200"></canvas>
            </div>
            <div class="chart-container glass-card">
                <h3 class="chart-title">è®¢å•çŠ¶æ€åˆ†å¸ƒ</h3>
                <canvas id="ordersChart" width="300" height="200"></canvas>
            </div>
            <div class="chart-container glass-card">
                <h3 class="chart-title">äº§å“é”€å”®å æ¯”</h3>
                <canvas id="productsChart" width="300" height="200"></canvas>
            </div>
        </div>
        
        <div class="section">
            <h2 class="section-title">æœ€è¿‘è®¢å•</h2>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>è®¢å•å·</th>
                            <th>ç”¨æˆ·</th>
                            <th>å•†å“</th>
                            <th>é‡‘é¢</th>
                            <th>çŠ¶æ€</th>
                            <th>æ—¶é—´</th>
                        </tr>
                    </thead>
                    <tbody>
                        {{range .recent_orders}}
                        <tr>
                            <td>#{{.ID}}</td>
                            <td>{{.User.Username}}</td>
                            <td>
                                {{if .Product}}
                                    {{.Product.Name}}
                                {{else}}
                                    ä½™é¢å……å€¼
                                {{end}}
                            </td>
                            <td>{{$.currency}}{{printf "%.2f" (divf .AmountCents 100)}}</td>
                            <td>
                                {{if eq .Status "pending"}}
                                    <span class="status-badge status-pending">å¾…æ”¯ä»˜</span>
                                {{else if eq .Status "paid"}}
                                    <span class="status-badge status-paid">å·²æ”¯ä»˜</span>
                                {{else if eq .Status "delivered"}}
                                    <span class="status-badge status-delivered">å·²å‘è´§</span>
                                {{else}}
                                    <span class="status-badge">{{.Status}}</span>
                                {{end}}
                            </td>
                            <td>{{.CreatedAt.Format "2006-01-02 15:04"}}</td>
                        </tr>
                        {{end}}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    
    <script src="/static/theme.js"></script>
    <script src="/static/ui-enhancements.js"></script>
    <script src="/static/charts.js"></script>
    <script>
        // Theme toggle function
        function toggleTheme() {
            if (window.themeManager) {
                window.themeManager.toggleTheme();
            }
        }
    </script>
</body>
</html>